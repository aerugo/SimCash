{
  "version": "1.0",
  "policy_id": "default_end_of_tick_cleanup",
  "description": "Conservative end-of-tick collateral cleanup policy. Withdraws posted collateral only when: (1) RTGS queue is empty (no pending urgent settlements), AND (2) Agent has sufficient headroom (2x Queue 1 total value) to handle all queued payments without the collateral.",

  "payment_tree": null,

  "strategic_collateral_tree": null,

  "end_of_tick_collateral_tree": {
    "node_id": "EOT1",
    "type": "condition",
    "description": "Check if RTGS queue is empty (no urgent settlements pending)",
    "condition": {
      "op": "==",
      "left": {"field": "queue2_size"},
      "right": {"value": 0}
    },
    "on_true": {
      "node_id": "EOT2",
      "type": "condition",
      "description": "Check if headroom >= 2x Queue 1 total value (safe to withdraw)",
      "condition": {
        "op": ">=",
        "left": {"field": "headroom"},
        "right": {
          "compute": {
            "op": "*",
            "left": {"field": "queue1_total_value"},
            "right": {"value": 2.0}
          }
        }
      },
      "on_true": {
        "node_id": "EOT3",
        "type": "action",
        "action": "WithdrawCollateral",
        "parameters": {
          "amount": {"field": "posted_collateral"},
          "reason": {"value": "EndOfDayCleanup"}
        }
      },
      "on_false": {
        "node_id": "EOT4",
        "type": "action",
        "action": "HoldCollateral"
      }
    },
    "on_false": {
      "node_id": "EOT5",
      "type": "action",
      "action": "HoldCollateral",
      "description": "RTGS queue not empty - keep collateral available"
    }
  },

  "parameters": {}
}
