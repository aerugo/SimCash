# 12-Bank Multi-Policy Comparison Simulation
#
# Configuration: 12 banks using 4 distinct JSON policies, each configured 3 different ways
# - Adaptive Liquidity Manager: Cost-aware, time-based, gridlock-aware (3 variants)
# - Agile Regional Bank: Cost-optimizing with splitting and reactive collateral (3 variants)
# - Goliath National Bank: Conservative, time-adaptive, proactive collateral (3 variants)
# - Momentum Investment Bank: Aggressive, system-aware, minimal collateral (3 variants)
#
# Scenario design:
# - 200 ticks/day over 5 days = 1000 total ticks (realistic intraday granularity)
# - Mixed liquidity profiles from constrained to abundant
# - Varied transaction patterns to stress-test all policy strategies
# - Cost rates calibrated to make policy decisions economically meaningful

simulation:
  ticks_per_day: 200
  num_days: 5
  rng_seed: 42

# ============================================================================
# POLICY 1: ADAPTIVE LIQUIDITY MANAGER (3 configurations)
# Strategy: Cost-aware, time-based, gridlock-aware with multi-layer collateral
# ============================================================================

agents:
  # ==========================================================================
  # ALM-1: Conservative Configuration
  # High liquidity, low volume, defensive collateral strategy
  # ==========================================================================
  - id: "ALM_CONSERVATIVE"
    opening_balance: 50000000    # $500,000 - Strong liquidity cushion
    credit_limit: 30000000       # $300,000 credit available
    policy:
      type: "FromJson"
      json_path: "backend/policies/adaptive_liquidity_manager.json"
    arrival_config:
      rate_per_tick: 0.4         # ~80 transactions/day (conservative volume)
      amount_distribution:
        type: "LogNormal"
        mean: 11.5               # ~$1,000 median
        std_dev: 0.8
      counterparty_weights:
        ALM_BALANCED: 0.10
        ALM_AGGRESSIVE: 0.08
        ARB_LARGE_REGIONAL: 0.12
        ARB_MEDIUM_REGIONAL: 0.10
        ARB_SMALL_REGIONAL: 0.08
        GNB_TIER1_BEHEMOTH: 0.15
        GNB_MAJOR_NATIONAL: 0.12
        GNB_REGIONAL_NATIONAL: 0.10
        MIB_PRIME_BROKER: 0.08
        MIB_HEDGE_FUND_DESK: 0.05
        MIB_PROP_TRADING: 0.02
      deadline_range: [50, 150]  # Relaxed deadlines
      priority: 5
      divisible: false

  # ==========================================================================
  # ALM-2: Balanced Configuration
  # Medium liquidity, moderate volume, strategic collateral use
  # ==========================================================================
  - id: "ALM_BALANCED"
    opening_balance: 30000000    # $300,000 - Moderate liquidity
    credit_limit: 25000000       # $250,000 credit
    policy:
      type: "FromJson"
      json_path: "backend/policies/adaptive_liquidity_manager.json"
    arrival_config:
      rate_per_tick: 0.6         # ~120 transactions/day
      amount_distribution:
        type: "LogNormal"
        mean: 11.0
        std_dev: 1.0
      counterparty_weights:
        ALM_CONSERVATIVE: 0.10
        ALM_AGGRESSIVE: 0.10
        ARB_LARGE_REGIONAL: 0.10
        ARB_MEDIUM_REGIONAL: 0.12
        ARB_SMALL_REGIONAL: 0.08
        GNB_TIER1_BEHEMOTH: 0.12
        GNB_MAJOR_NATIONAL: 0.12
        GNB_REGIONAL_NATIONAL: 0.10
        MIB_PRIME_BROKER: 0.08
        MIB_HEDGE_FUND_DESK: 0.06
        MIB_PROP_TRADING: 0.02
      deadline_range: [30, 100]
      priority: 5
      divisible: false

  # ==========================================================================
  # ALM-3: Aggressive Configuration
  # Lower liquidity, high volume, relies heavily on collateral
  # ==========================================================================
  - id: "ALM_AGGRESSIVE"
    opening_balance: 20000000    # $200,000 - Constrained liquidity
    credit_limit: 35000000       # $350,000 credit (higher than balance!)
    policy:
      type: "FromJson"
      json_path: "backend/policies/adaptive_liquidity_manager.json"
    arrival_config:
      rate_per_tick: 0.8         # ~160 transactions/day (high volume)
      amount_distribution:
        type: "LogNormal"
        mean: 10.5
        std_dev: 1.2
      counterparty_weights:
        ALM_CONSERVATIVE: 0.08
        ALM_BALANCED: 0.10
        ARB_LARGE_REGIONAL: 0.10
        ARB_MEDIUM_REGIONAL: 0.10
        ARB_SMALL_REGIONAL: 0.10
        GNB_TIER1_BEHEMOTH: 0.15
        GNB_MAJOR_NATIONAL: 0.12
        GNB_REGIONAL_NATIONAL: 0.10
        MIB_PRIME_BROKER: 0.08
        MIB_HEDGE_FUND_DESK: 0.05
        MIB_PROP_TRADING: 0.02
      deadline_range: [20, 80]   # Tighter deadlines
      priority: 6
      divisible: false

# ============================================================================
# POLICY 2: AGILE REGIONAL BANK (3 configurations)
# Strategy: Cost-optimizing with payment splitting and reactive collateral
# ============================================================================

  # ==========================================================================
  # ARB-1: Large Regional Configuration
  # Strong liquidity, active splitting strategy
  # ==========================================================================
  - id: "ARB_LARGE_REGIONAL"
    opening_balance: 45000000    # $450,000
    credit_limit: 28000000       # $280,000 credit
    policy:
      type: "FromJson"
      json_path: "backend/policies/agile_regional_bank.json"
    arrival_config:
      rate_per_tick: 0.5         # ~100 transactions/day
      amount_distribution:
        type: "Uniform"
        min: 50000               # $500
        max: 800000              # $8,000
      counterparty_weights:
        ALM_CONSERVATIVE: 0.12
        ALM_BALANCED: 0.10
        ALM_AGGRESSIVE: 0.10
        ARB_MEDIUM_REGIONAL: 0.10
        ARB_SMALL_REGIONAL: 0.08
        GNB_TIER1_BEHEMOTH: 0.15
        GNB_MAJOR_NATIONAL: 0.12
        GNB_REGIONAL_NATIONAL: 0.10
        MIB_PRIME_BROKER: 0.07
        MIB_HEDGE_FUND_DESK: 0.04
        MIB_PROP_TRADING: 0.02
      deadline_range: [40, 120]
      priority: 5
      divisible: true            # Splitting enabled

  # ==========================================================================
  # ARB-2: Medium Regional Configuration
  # Moderate liquidity, selective splitting
  # ==========================================================================
  - id: "ARB_MEDIUM_REGIONAL"
    opening_balance: 28000000    # $280,000
    credit_limit: 22000000       # $220,000 credit
    policy:
      type: "FromJson"
      json_path: "backend/policies/agile_regional_bank.json"
    arrival_config:
      rate_per_tick: 0.55        # ~110 transactions/day
      amount_distribution:
        type: "Uniform"
        min: 40000
        max: 600000
      counterparty_weights:
        ALM_CONSERVATIVE: 0.10
        ALM_BALANCED: 0.12
        ALM_AGGRESSIVE: 0.10
        ARB_LARGE_REGIONAL: 0.10
        ARB_SMALL_REGIONAL: 0.10
        GNB_TIER1_BEHEMOTH: 0.12
        GNB_MAJOR_NATIONAL: 0.12
        GNB_REGIONAL_NATIONAL: 0.10
        MIB_PRIME_BROKER: 0.08
        MIB_HEDGE_FUND_DESK: 0.04
        MIB_PROP_TRADING: 0.02
      deadline_range: [30, 100]
      priority: 5
      divisible: true

  # ==========================================================================
  # ARB-3: Small Regional Configuration
  # Constrained liquidity, reactive strategy, relies on collateral
  # ==========================================================================
  - id: "ARB_SMALL_REGIONAL"
    opening_balance: 18000000    # $180,000 - Tight liquidity
    credit_limit: 20000000       # $200,000 credit
    policy:
      type: "FromJson"
      json_path: "backend/policies/agile_regional_bank.json"
    arrival_config:
      rate_per_tick: 0.65        # ~130 transactions/day (high for size)
      amount_distribution:
        type: "Uniform"
        min: 30000
        max: 500000
      counterparty_weights:
        ALM_CONSERVATIVE: 0.08
        ALM_BALANCED: 0.10
        ALM_AGGRESSIVE: 0.10
        ARB_LARGE_REGIONAL: 0.08
        ARB_MEDIUM_REGIONAL: 0.10
        GNB_TIER1_BEHEMOTH: 0.15
        GNB_MAJOR_NATIONAL: 0.12
        GNB_REGIONAL_NATIONAL: 0.10
        MIB_PRIME_BROKER: 0.08
        MIB_HEDGE_FUND_DESK: 0.06
        MIB_PROP_TRADING: 0.03
      deadline_range: [25, 90]
      priority: 6
      divisible: true

# ============================================================================
# POLICY 3: GOLIATH NATIONAL BANK (3 configurations)
# Strategy: Conservative, time-adaptive with tiered buffers, proactive collateral
# ============================================================================

  # ==========================================================================
  # GNB-1: Tier 1 Behemoth Configuration
  # Massive liquidity, highest volume, maintains large buffers
  # ==========================================================================
  - id: "GNB_TIER1_BEHEMOTH"
    opening_balance: 80000000    # $800,000 - Dominant liquidity
    credit_limit: 50000000       # $500,000 credit
    policy:
      type: "FromJson"
      json_path: "backend/policies/goliath_national_bank.json"
    arrival_config:
      rate_per_tick: 0.7         # ~140 transactions/day
      amount_distribution:
        type: "LogNormal"
        mean: 12.0               # Larger transactions
        std_dev: 1.0
      counterparty_weights:
        ALM_CONSERVATIVE: 0.10
        ALM_BALANCED: 0.10
        ALM_AGGRESSIVE: 0.10
        ARB_LARGE_REGIONAL: 0.10
        ARB_MEDIUM_REGIONAL: 0.10
        ARB_SMALL_REGIONAL: 0.08
        GNB_MAJOR_NATIONAL: 0.12
        GNB_REGIONAL_NATIONAL: 0.10
        MIB_PRIME_BROKER: 0.10
        MIB_HEDGE_FUND_DESK: 0.07
        MIB_PROP_TRADING: 0.03
      deadline_range: [60, 160]  # Very relaxed deadlines
      priority: 7
      divisible: false

  # ==========================================================================
  # GNB-2: Major National Configuration
  # Large liquidity, high volume, strict buffer maintenance
  # ==========================================================================
  - id: "GNB_MAJOR_NATIONAL"
    opening_balance: 55000000    # $550,000
    credit_limit: 38000000       # $380,000 credit
    policy:
      type: "FromJson"
      json_path: "backend/policies/goliath_national_bank.json"
    arrival_config:
      rate_per_tick: 0.65        # ~130 transactions/day
      amount_distribution:
        type: "LogNormal"
        mean: 11.5
        std_dev: 0.9
      counterparty_weights:
        ALM_CONSERVATIVE: 0.10
        ALM_BALANCED: 0.10
        ALM_AGGRESSIVE: 0.10
        ARB_LARGE_REGIONAL: 0.10
        ARB_MEDIUM_REGIONAL: 0.10
        ARB_SMALL_REGIONAL: 0.08
        GNB_TIER1_BEHEMOTH: 0.12
        GNB_REGIONAL_NATIONAL: 0.10
        MIB_PRIME_BROKER: 0.10
        MIB_HEDGE_FUND_DESK: 0.07
        MIB_PROP_TRADING: 0.03
      deadline_range: [50, 140]
      priority: 6
      divisible: false

  # ==========================================================================
  # GNB-3: Regional National Configuration
  # Good liquidity, moderate volume, time-adaptive
  # ==========================================================================
  - id: "GNB_REGIONAL_NATIONAL"
    opening_balance: 38000000    # $380,000
    credit_limit: 28000000       # $280,000 credit
    policy:
      type: "FromJson"
      json_path: "backend/policies/goliath_national_bank.json"
    arrival_config:
      rate_per_tick: 0.55        # ~110 transactions/day
      amount_distribution:
        type: "LogNormal"
        mean: 11.0
        std_dev: 0.85
      counterparty_weights:
        ALM_CONSERVATIVE: 0.10
        ALM_BALANCED: 0.10
        ALM_AGGRESSIVE: 0.10
        ARB_LARGE_REGIONAL: 0.10
        ARB_MEDIUM_REGIONAL: 0.10
        ARB_SMALL_REGIONAL: 0.08
        GNB_TIER1_BEHEMOTH: 0.12
        GNB_MAJOR_NATIONAL: 0.12
        MIB_PRIME_BROKER: 0.09
        MIB_HEDGE_FUND_DESK: 0.06
        MIB_PROP_TRADING: 0.03
      deadline_range: [40, 120]
      priority: 5
      divisible: false

# ============================================================================
# POLICY 4: MOMENTUM INVESTMENT BANK (3 configurations)
# Strategy: Aggressive release, system-aware, holds trivial payments
# ============================================================================

  # ==========================================================================
  # MIB-1: Prime Broker Configuration
  # High liquidity, very high volume, aggressive with large payments
  # ==========================================================================
  - id: "MIB_PRIME_BROKER"
    opening_balance: 42000000    # $420,000
    credit_limit: 32000000       # $320,000 credit
    policy:
      type: "FromJson"
      json_path: "backend/policies/momentum_investment_bank.json"
    arrival_config:
      rate_per_tick: 0.9         # ~180 transactions/day (highest volume)
      amount_distribution:
        type: "LogNormal"
        mean: 10.8
        std_dev: 1.3             # High variance
      counterparty_weights:
        ALM_CONSERVATIVE: 0.08
        ALM_BALANCED: 0.08
        ALM_AGGRESSIVE: 0.08
        ARB_LARGE_REGIONAL: 0.07
        ARB_MEDIUM_REGIONAL: 0.08
        ARB_SMALL_REGIONAL: 0.08
        GNB_TIER1_BEHEMOTH: 0.15
        GNB_MAJOR_NATIONAL: 0.12
        GNB_REGIONAL_NATIONAL: 0.10
        MIB_HEDGE_FUND_DESK: 0.10
        MIB_PROP_TRADING: 0.06
      deadline_range: [20, 80]   # Tight deadlines
      priority: 7
      divisible: false

  # ==========================================================================
  # MIB-2: Hedge Fund Desk Configuration
  # Medium liquidity, very high volume, diverse counterparties
  # ==========================================================================
  - id: "MIB_HEDGE_FUND_DESK"
    opening_balance: 32000000    # $320,000
    credit_limit: 28000000       # $280,000 credit
    policy:
      type: "FromJson"
      json_path: "backend/policies/momentum_investment_bank.json"
    arrival_config:
      rate_per_tick: 1.0         # ~200 transactions/day (very high)
      amount_distribution:
        type: "LogNormal"
        mean: 10.3
        std_dev: 1.4
      counterparty_weights:
        ALM_CONSERVATIVE: 0.05
        ALM_BALANCED: 0.06
        ALM_AGGRESSIVE: 0.05
        ARB_LARGE_REGIONAL: 0.04
        ARB_MEDIUM_REGIONAL: 0.06
        ARB_SMALL_REGIONAL: 0.06
        GNB_TIER1_BEHEMOTH: 0.15
        GNB_MAJOR_NATIONAL: 0.12
        GNB_REGIONAL_NATIONAL: 0.10
        MIB_PRIME_BROKER: 0.10
        MIB_PROP_TRADING: 0.21    # Heavy interaction with prop desk
      deadline_range: [15, 70]
      priority: 6
      divisible: false

  # ==========================================================================
  # MIB-3: Prop Trading Configuration
  # Moderate liquidity, extremely high volume, many small payments
  # ==========================================================================
  - id: "MIB_PROP_TRADING"
    opening_balance: 25000000    # $250,000
    credit_limit: 22000000       # $220,000 credit
    policy:
      type: "FromJson"
      json_path: "backend/policies/momentum_investment_bank.json"
    arrival_config:
      rate_per_tick: 1.1         # ~220 transactions/day (extreme volume)
      amount_distribution:
        type: "LogNormal"
        mean: 9.8                # Smaller transactions
        std_dev: 1.5             # Very high variance
      counterparty_weights:
        ALM_CONSERVATIVE: 0.02
        ALM_BALANCED: 0.02
        ALM_AGGRESSIVE: 0.02
        ARB_LARGE_REGIONAL: 0.02
        ARB_MEDIUM_REGIONAL: 0.03
        ARB_SMALL_REGIONAL: 0.03
        GNB_TIER1_BEHEMOTH: 0.15
        GNB_MAJOR_NATIONAL: 0.12
        GNB_REGIONAL_NATIONAL: 0.10
        MIB_PRIME_BROKER: 0.06
        MIB_HEDGE_FUND_DESK: 0.43  # Heavy flow to hedge fund desk
      deadline_range: [10, 60]   # Very tight deadlines
      priority: 5
      divisible: false

# ============================================================================
# LSM CONFIGURATION
# Enable bilateral offsetting and cycle detection with multiple iterations
# ============================================================================

lsm_config:
  bilateral_offsetting: true
  cycle_detection: true
  max_iterations: 10            # More iterations for complex 12-bank network

# ============================================================================
# COST CONFIGURATION
# Calibrated to make policy decisions economically meaningful
# ============================================================================

cost_rates:
  overdraft_bps_per_tick: 0.5               # 0.5 bp per tick (reasonable for 200 ticks/day)
  delay_cost_per_tick_per_cent: 0.0001     # $0.001 per cent per tick
  collateral_cost_per_tick_bps: 0.0003     # 0.03 bp per tick (annualized ~5.4% with 200 ticks)
  eod_penalty_per_transaction: 500000       # $5,000 penalty for unsettled at EOD
  deadline_penalty: 250000                  # $2,500 penalty for missing deadline
  split_friction_cost: 5000                 # $50 cost to split a transaction

# ============================================================================
# EXPECTED DYNAMICS
# ============================================================================
#
# This scenario tests all four policy types under realistic conditions:
#
# 1. ADAPTIVE LIQUIDITY MANAGER banks will demonstrate:
#    - Cost-aware decision making comparing overdraft vs delay costs
#    - Time-based urgency with EOD rush detection
#    - Strategic collateral posting when gaps emerge late in day
#    - End-of-tick collateral optimization (withdraw excess)
#
# 2. AGILE REGIONAL BANK variants will show:
#    - Payment splitting when facing liquidity constraints
#    - Cost-benefit analysis (delay vs overdraft vs splitting)
#    - Reactive collateral management (post when gap appears)
#    - Different split strategies based on bank size
#
# 3. GOLIATH NATIONAL BANK tiers will exhibit:
#    - Time-adaptive buffer strategies (conservative early, aggressive late)
#    - Proactive collateral posting before gaps emerge
#    - Strict liquidity preservation
#    - Tier-based risk management (larger banks more conservative)
#
# 4. MOMENTUM INVESTMENT BANK desks will display:
#    - Aggressive payment release (near-FIFO)
#    - System congestion awareness (pause when RTGS overloaded)
#    - Deprioritization of trivial payments
#    - No collateral management (pure liquidity-based strategy)
#
# Network effects:
# - High-volume MIB banks will stress the system
# - Conservative GNB banks will provide stability
# - ALM banks will adapt strategically to changing conditions
# - ARB banks will optimize through splitting and reactive collateral
#
# With 200 ticks/day over 5 days, this creates realistic intraday dynamics
# where time-based strategies can shine and cost comparisons are meaningful.
