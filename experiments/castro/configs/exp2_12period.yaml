# Experiment 2: 12-Period Stochastic (LVTS-Style)
#
# Realistic scenario with stochastic payment arrivals.
# Uses Poisson arrivals with LogNormal amounts.
#
# From Castro et al. (2025) Section 4.2

simulation:
  ticks_per_day: 12
  num_days: 1
  rng_seed: 42

# Castro paper rules
deferred_crediting: true
deadline_cap_at_eod: true

cost_rates:
  # Castro paper requires: r_c < r_d < r_b
  # r_c = collateral cost, r_d = delay cost, r_b = EOD borrowing cost
  #
  # Collateral cost: ~42 bps per tick (500 bps/day รท 12 ticks)
  # For 10000 cents: 10000 * 0.0042 = 42 cents/tick
  collateral_cost_per_tick_bps: 42
  # Delay cost: 0.01 per tick per cent (must exceed collateral cost)
  # For 10000 cents: 10000 * 0.01 = 100 cents/tick (> 42, satisfies r_d > r_c)
  delay_cost_per_tick_per_cent: 0.01
  # Overdraft penalty
  overdraft_bps_per_tick: 167
  # EOD penalty: must be > delay cost (r_b > r_d)
  eod_penalty_per_transaction: 100000
  # Deadline penalty: penalty when transaction becomes overdue
  deadline_penalty: 50000
  split_friction_cost: 0

# Disable LSM for Castro experiments
lsm_config:
  enable_bilateral: false
  enable_cycles: false

agents:
  - id: BANK_A
    opening_balance: 0
    # CRITICAL: No unsecured credit - matches paper assumption that
    # liquidity ONLY comes from posted collateral (incurring r_c cost)
    unsecured_cap: 0
    max_collateral_capacity: 10000000
    # Stochastic arrivals
    arrival_config:
      rate_per_tick: 2.0  # Poisson lambda
      amount_distribution:
        type: LogNormal
        mean: 10000
        std_dev: 5000
      counterparty_weights:
        BANK_B: 1.0
      deadline_range: [3, 8]  # [min_ticks, max_ticks]

  - id: BANK_B
    opening_balance: 0
    # CRITICAL: No unsecured credit
    unsecured_cap: 0
    max_collateral_capacity: 10000000
    arrival_config:
      rate_per_tick: 2.0
      amount_distribution:
        type: LogNormal
        mean: 10000
        std_dev: 5000
      counterparty_weights:
        BANK_A: 1.0
      deadline_range: [3, 8]
