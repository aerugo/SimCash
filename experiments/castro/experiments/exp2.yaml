# Experiment 2: 12-Period Stochastic
# LVTS-style realistic scenario with stochastic arrivals.
#
# Setup:
# - 12 ticks per day
# - Poisson arrivals, LogNormal amounts
# - 10 bootstrap samples for evaluation

name: exp2
description: "12-Period Stochastic LVTS-Style"

# Scenario configuration (relative to this file's directory)
scenario: ../configs/exp2_12period.yaml

# Evaluation settings
evaluation:
  mode: bootstrap
  num_samples: 10  # Bootstrap samples for evaluation
  ticks: 12

# Convergence criteria
convergence:
  max_iterations: 25
  stability_threshold: 0.05
  stability_window: 5

# LLM configuration
llm:
  model: "openai:gpt-5.2"
  temperature: 0.5
  max_retries: 3
  timeout_seconds: 900
  reasoning_effort: "high"

# Policy constraints - simplified for Castro model
# The Castro model has ONE key decision: initial liquidity allocation
policy_constraints:
  allowed_parameters:
    - name: initial_liquidity_fraction
      param_type: float
      min_value: 0.0
      max_value: 1.0
      description: "Fraction of available collateral to post at the start of day (t=0)"

  allowed_fields:
    # Time context - needed for initial collateral decision
    - system_tick_in_day
    # Collateral capacity - needed to compute initial allocation
    - remaining_collateral_capacity
    - max_collateral_capacity
    # Liquidity state - for understanding when payments can settle
    - balance
    - effective_liquidity
    # Transaction context - for payment decisions
    - amount
    - remaining_amount

  allowed_actions:
    payment_tree:
      - Release
      - Hold
    bank_tree:
      - NoAction
    collateral_tree:
      - PostCollateral
      - HoldCollateral

# Experiment customization - guides LLM without giving away answer
prompt_customization:
  all: |
    ## Experiment Focus: Initial Liquidity Allocation

    This scenario tests a fundamental tradeoff in payment systems:
    - Posting collateral provides liquidity to settle payments
    - But collateral has an opportunity cost

    The KEY DECISION in this scenario is: What fraction of available collateral
    should be posted at the START of the day (tick 0)?

    The payment policy should be kept SIMPLE:
    - If you have liquidity, release payments
    - The complexity is in choosing the RIGHT initial liquidity level

    IMPORTANT: Focus your optimization on the `initial_liquidity_fraction` parameter.
    The payment_tree should remain a simple Release action - the real optimization
    is in how much collateral to commit upfront.

# Agents to optimize
optimized_agents:
  - BANK_A
  - BANK_B

# Output settings
output:
  directory: results
  database: exp2.db
  verbose: true

# Master seed for reproducibility
master_seed: 42
