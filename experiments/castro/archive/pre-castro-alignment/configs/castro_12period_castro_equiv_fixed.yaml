# Castro et al. (2025) - 12-Period LVTS-Style Scenario (CASTRO-EQUIVALENT)
# Experiment 2d-fixed: Corrected collateral capacity calculation
#
# ISSUE FIXED:
# - max_collateral_capacity in config is IGNORED
# - It's computed as 10 × unsecured_cap
# - With $100M unsecured_cap, max_collateral_capacity = $1B
# - We must adjust policy fractions accordingly
#
# TARGET: ~$250k posted collateral (50% of intended $500k capacity)
# With $1B actual capacity: fraction = $250k / $1B = 0.00025

simulation:
  ticks_per_day: 12
  num_days: 1
  rng_seed: 42

# Cost mapping from Castro's daily rates to per-tick rates
# Castro: r_c = 0.1, r_d = 0.2, r_b = 0.4 (all per day)
cost_rates:
  # r_c (collateral opportunity cost): 0.1/day → 83 bps/tick
  collateral_cost_per_tick_bps: 83

  # r_d (delay cost): 0.2/day → 0.00017 per cent per tick
  delay_cost_per_tick_per_cent: 0.00017

  # r_b (overdraft/borrowing cost): 0.4/day → 333 bps/tick
  overdraft_bps_per_tick: 333

  # Castro-equivalent: NO hard penalties
  eod_penalty_per_transaction: 0
  deadline_penalty: 0
  split_friction_cost: 0
  overdue_delay_multiplier: 1.0

lsm_config:
  enable_bilateral: false
  enable_cycles: false
  max_cycle_length: 3
  max_cycles_per_tick: 1

agents:
  - id: BANK_A
    opening_balance: 0
    # CASTRO-EQUIVALENT: Unlimited credit
    unsecured_cap: 10000000000  # $100M
    # NOTE: max_collateral_capacity = 10 × $100M = $1B (computed, not configurable)
    # To get ~$250k collateral, use fraction = 0.00025
    policy:
      type: FromJson
      json_path: "experiments/castro/policies/exp2d_fixed_bank_a.json"
    arrival_config:
      rate_per_tick: 0.5
      amount_distribution:
        type: LogNormal
        mean: 11.51  # ~$100k median
        std_dev: 0.9
      counterparty_weights:
        BANK_B: 1.0
      deadline_range: [3, 8]
      priority: 5
      divisible: false

  - id: BANK_B
    opening_balance: 0
    unsecured_cap: 10000000000  # $100M
    policy:
      type: FromJson
      json_path: "experiments/castro/policies/exp2d_fixed_bank_b.json"
    arrival_config:
      rate_per_tick: 0.65
      amount_distribution:
        type: LogNormal
        mean: 11.8  # ~$120k median
        std_dev: 1.0
      counterparty_weights:
        BANK_A: 1.0
      deadline_range: [2, 6]
      priority: 5
      divisible: false
